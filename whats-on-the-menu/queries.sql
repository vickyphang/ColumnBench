SELECT count(*) FROM menu_item_denorm;
SELECT ROUND(TO_NUMBER(SUBSTRING(menu_date FROM '^\d{4}'), '9999') / 10) * 10 AS d, COUNT(*) AS total_count, ROUND(AVG(price), 2) AS average_price, REPEAT('#', CAST(ROUND(AVG(price) / 100 * 100) AS INTEGER)) AS bar_chart FROM menu_item_denorm WHERE menu_currency = 'Dollars' AND TO_NUMBER(SUBSTRING(menu_date FROM '^\d{4}'), '9999') > 0 AND TO_NUMBER(SUBSTRING(menu_date FROM '^\d{4}'), '9999') < 2022 GROUP BY d ORDER BY d ASC;
SELECT ROUND(TO_NUMBER(SUBSTRING(menu_date FROM '^\d{4}'), '9999') / 10) * 10 AS d, COUNT(*) AS total_count, ROUND(AVG(price), 2) AS average_price, REPEAT('#', CAST(ROUND(AVG(price) / 50 * 100) AS INTEGER)) AS bar_chart FROM menu_item_denorm WHERE menu_currency = 'Dollars' AND TO_NUMBER(SUBSTRING(menu_date FROM '^\d{4}'), '9999') > 0 AND TO_NUMBER(SUBSTRING(menu_date FROM '^\d{4}'), '9999') < 2022 AND dish_name ILIKE '%burger%' GROUP BY d ORDER BY d ASC;
SELECT ROUND(TO_NUMBER(SUBSTRING(menu_date FROM '^\d{4}'), '9999') / 10) * 10 AS d, COUNT(*) AS total_count, ROUND(AVG(price), 2) AS average_price, REPEAT('#', CAST(ROUND(AVG(price) / 50 * 100) AS INTEGER)) AS bar_chart FROM menu_item_denorm WHERE menu_currency IN ('Dollars', '') AND TO_NUMBER(SUBSTRING(menu_date FROM '^\d{4}'), '9999') > 0 AND TO_NUMBER(SUBSTRING(menu_date FROM '^\d{4}'), '9999') < 2022 AND dish_name ILIKE '%vodka%' GROUP BY d ORDER BY d ASC;
SELECT ROUND(TO_NUMBER(SUBSTRING(menu_date FROM '^\d{4}'), '9999') / 10) * 10 AS d, COUNT(*) AS total_count, ROUND(AVG(price), 2) AS average_price, REPEAT('#', CAST(ROUND(AVG(price) / 50 * 100) AS INTEGER)) AS bar_chart, MIN(dish_name) AS example_dish_name FROM menu_item_denorm WHERE menu_currency IN ('Dollars', '') AND TO_NUMBER(SUBSTRING(menu_date FROM '^\d{4}'), '9999') > 0 AND TO_NUMBER(SUBSTRING(menu_date FROM '^\d{4}'), '9999') < 2022 AND dish_name ILIKE '%caviar%' GROUP BY d ORDER BY d ASC;